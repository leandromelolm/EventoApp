<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head th:replace="fragments :: html_head" />

<body onload="nomeUsuarioLogado()">

	<div th:replace="fragments :: menu" />
	
	<div class="container">
	
		<div>
			<div>
				</p>
				<a onclick="return confirmaDeslogar();" sec:authorize="isAuthenticated()" href="/logout"
					class="waves-effect waves-light btn">Logout</a>
				<a id="btncadastrar" href="/login.html" sec:authorize="!isAuthenticated()"
					class="waves-effect waves-light btn">Entrar</a>
			</div>
			</p>
			<a id="btncadastrar" href="/cadastrarEvento" class="waves-effect waves-light btn">Cadastrar Evento</a>
			</p>	
	
			<p th:text="${session.mySessionAttribute}" th:unless="${session == null}">[...]</p>	
		</div>
		
	
		<div id="admin" sec:authorize="hasRole('ADMIN')">	
			
			<div sec:authorize="!isAuthenticated()">
				<p>[[${#authentication.name}]]!</p>
				<p>session <b>[[${#session}]]</b></p>
				<p>lastAccessedTime <b>[[${#session.lastAccessedTime}]]</b></p>
				<p>id <b>[[${#session.id}]]</b></p>
			</div>
	
			<div sec:authorize="isAuthenticated()">
				<p>[[${#authentication.name}]]!</p>
				<p>session <b>[[${#session}]]</b></p>
				<p>lastAccessedTime <b>[[${#session.lastAccessedTime}]]</b></p>
				<p>id <b>[[${#session.id}]]</b></p>
			</div>
	
	
			<div class="row">
				<div class="input-field col l2 m6 s12">
					<input type=text name="cdate" id="cdate" class="datepicker">
					<label for="cdate">Calendario</label>
				</div>
			</div>
	
	
			<p><b th:text="${mensagem}"></b></p>
			<th:block th:include="mensagemValidacao"></th:block>
			<p th:text="| Nome do usuario da sessão:  ${session.mySessionAttribute}|" th:unless="${session == null}">[...]
			</p>
	
			<table border="1" class="table table-striped table-responsive-md">
				<tr th:each="u : ${usuario}">
					<td><span th:text="${u.nome}"></span></td>
					<td><span th:text="${u.cpf}"></span></td>
					<td><span th:text="${u.email}"></span></td>
				</tr>
			</table>	
	
			<div sec:authorize="hasRole('USER')">Text visible to user.</div>
			<div sec:authorize="hasRole('ADMIN')">Text visible to admin (usuario administrador).</div>
			<div sec:authorize="isAuthenticated()"> Text visible only to authenticated users.</div>
			<div> Authenticated username: <span sec:authentication="name"></span> </div>
	
			<div sec:authorize="hasRole('ROLE_ADMIN')">
				USER ADMINISTRADOR -This content is only shown to administrators.
			</div>
			<div sec:authorize="hasRole('ROLE_STANDARD_USER')">
				USER NORMAL -This content is only shown to users.
			</div>
			<!--		Authenticated user roles:<div sec:authentication="principal.authorities"></div>-->
			<!--		Roles: <span sec:authentication="principal.authorities">[ROLE_STANDARD_USER, ROLE_ADMIN]</span>-->
	
			</p>
			<div>
				<button onclick="window.location.href = '/logout'">Sair</button>
			</div>
			</p>
		</div>
		
	
		<div>
			<form name="formulario" id="formulario" class="formulario" method="get">
				<div class="show">
					User Logado:<input id="formname" name="emailResponsavelEvento" th:value="${#authentication.name}"
						readonly=true />
				</div>
				<button class="waves-effect waves-light btn input-field" type="submit">Salvar</button>
			</form>
		</div>
	
	</div>
	
	
	
	<script>
		window.onload = function () {	
			console.log("function called...");
			let nome = document.getElementById("formname").value
    		console.log(nome)
    		//Função do Ajax para enviar uma solicitação get
  			$.ajax({
 		 		type: "POST",
 		 		url: "/testepost",
  				data: nome,  // usuario-padrao%40email.com=	   
  				dataType: "text",
  				//data: JSON.stringify(nome), // %22usuario-padrao%40email.com%22=
        		//dataType: 'json',
  				//success: function(){
           		//	alert("success");
        		//}
			});   	
		}		
	</script>
	
	<script type="text/javascript" src="/js/main.js"></script>
	<script type="text/javascript" src="/js/test.js"></script>
	<script type="text/javascript" src="/materialize/js/materialize.min.js"></script>
</body>

</html>